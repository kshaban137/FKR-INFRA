<!DOCTYPE html>
<html lang="en" class="dark">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FKR INFRA | Excellence in Engineering</title>
    <meta name="description" content="FKR Infra Private Limited - Premier Excavation, Piling, and Civil Works.">
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    fontFamily: {
                        sans: ['Manrope', 'sans-serif'],
                        display: ['Oswald', 'sans-serif'],
                        mono: ['JetBrains Mono', 'monospace'], 
                    },
                    colors: {
                        onyx: '#080808',       
                        charcoal: '#121212',   
                        paper: '#EAEAE6',      
                        ink: '#1a1a1a',        
                        champagne: '#E5C579',  
                        gold: '#D4AF37',       
                        silver: '#a1a1aa'      
                    },
                    cursor: {
                        none: 'none',
                    },
                    animation: {
                        'marquee': 'marquee 25s linear infinite',
                        'grain': 'grain 8s steps(10) infinite',
                    },
                    keyframes: {
                        marquee: {
                            '0%': { transform: 'translateX(0%)' },
                            '100%': { transform: 'translateX(-100%)' },
                        },
                        grain: {
                            '0%, 100%': { transform: 'translate(0, 0)' },
                            '10%': { transform: 'translate(-5%, -10%)' },
                            '20%': { transform: 'translate(-15%, 5%)' },
                            '30%': { transform: 'translate(7%, -25%)' },
                            '40%': { transform: 'translate(-5%, 25%)' },
                            '50%': { transform: 'translate(-15%, 10%)' },
                            '60%': { transform: 'translate(15%, 0%)' },
                            '70%': { transform: 'translate(0%, 15%)' },
                            '80%': { transform: 'translate(3%, 35%)' },
                            '90%': { transform: 'translate(-10%, 10%)' },
                        }
                    }
                }
            }
        }
    </script>

    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Manrope:wght@200;300;400;500;600;800&family=Oswald:wght@300;400;500;700&family=JetBrains+Mono:wght@400&display=swap" rel="stylesheet">

    <!-- Lenis Smooth Scroll -->
    <script src="https://unpkg.com/@studio-freight/lenis@1.0.42/dist/lenis.min.js"></script>

    <style>
        /* --- AWWWARDS LEVEL STYLING --- */
        :root {
            --cursor-size: 20px;
            --stroke-color: rgba(0, 0, 0, 0.8);
        }

        html.dark {
            --stroke-color: rgba(255, 255, 255, 0.8);
        }
        
        /* Utility to define stroke color based on theme */
        .text-stroke-dynamic {
            -webkit-text-stroke: 1px var(--stroke-color);
            color: transparent;
            transition: -webkit-text-stroke 0.5s ease;
        }

        body {
            margin: 0;
            transition: background-color 0.7s cubic-bezier(0.16, 1, 0.3, 1), color 0.7s cubic-bezier(0.16, 1, 0.3, 1);
            cursor: none; 
            overflow-x: hidden;
            -webkit-font-smoothing: antialiased;
        }
        
        body.pointer-active {
            cursor: pointer !important;
        }

        /* Advanced Noise Overlay for texture */
        .bg-noise {
            position: fixed;
            top: -50%; left: -50%; width: 200%; height: 200%;
            pointer-events: none;
            z-index: 9990;
            opacity: 0.06;
            background-image: url("data:image/svg+xml,%3Csvg viewBox='0 0 200 200' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='noiseFilter'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.65' numOctaves='3' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' fill='white' filter='url(%23noiseFilter)'/%3E%3C/svg%3E");
            background-size: 100px 100px;
            animation: grain 8s steps(10) infinite;
        }

        @media (hover: none) and (pointer: coarse) {
            body { cursor: auto; }
            .custom-cursor { display: none !important; }
        }

        html.lenis { height: auto; }
        .lenis.lenis-smooth { scroll-behavior: auto; }
        .lenis.lenis-smooth [data-lenis-prevent] { overscroll-behavior: contain; }
        .lenis.lenis-stopped { overflow: hidden; }

        ::-webkit-scrollbar { width: 0px; }
        ::selection { background-color: #E5C579; color: #080808; }

        /* Custom Cursor Styling */
        .custom-cursor {
            position: fixed;
            top: 0; left: 0;
            width: 12px; height: 12px;
            background-color: #E5C579;
            border-radius: 50%;
            pointer-events: none;
            z-index: 9999;
            transform: translate(-50%, -50%);
            transition: width 0.4s cubic-bezier(0.19, 1, 0.22, 1), height 0.4s cubic-bezier(0.19, 1, 0.22, 1), opacity 0.2s ease, background-color 0.5s ease;
            mix-blend-mode: difference;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .custom-cursor.active {
            width: 80px; height: 80px;
            background-color: white;
        }
        .custom-cursor.pointer-mode {
             width: 24px; height: 24px;
             opacity: 0.8;
        }

        .custom-cursor-text {
            opacity: 0;
            font-size: 10px;
            font-weight: 800;
            letter-spacing: 0.1em;
            text-transform: uppercase;
            color: black;
            transition: opacity 0.2s;
        }
        .custom-cursor.active .custom-cursor-text { opacity: 1; }

        .reveal-mask { overflow: hidden; display: block; }
        
        .input-enhanced {
            transition: all 0.3s ease;
        }
        .input-enhanced:focus {
            background-color: rgba(255, 255, 255, 0.1);
        }
    </style>
</head>

<body class="bg-paper text-ink dark:bg-onyx dark:text-white font-sans selection:bg-champagne selection:text-black">
    <div id="root"></div>

    <!-- Dependencies -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/framer-motion@11.0.14/dist/framer-motion.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

    <script type="text/babel">
        
        const { useState, useEffect, useRef, createContext, useContext } = React;
        const { motion, useScroll, useTransform, useSpring, AnimatePresence, useInView, useMotionValue, animate, useMotionValueEvent } = window.Motion;

        // CRITICAL: Preload list must match usage exactly to prevent "wrong image" issues
        const ASSETS_TO_PRELOAD = [
            "assets/RJ.jpg",
            "assets/Godrej Horizon.jpg",
            "assets/Piramal Agastya.jpg",
            "assets/Shagun grp.jpg",
            "assets/Tricone.webp",
            "assets/prince.png",
            "assets/logo.png",
            "assets/godrej.png",
            "assets/adani.png",
            "assets/Mahindra.png",
            "assets/ruparel.png",
            "assets/shagun.png"
        ];

        const CursorContext = createContext(null);
        const ScrollContext = createContext(null);
        const ThemeContext = createContext(null);
        const DelayContext = createContext(null); 
        const ENTRY_DELAY = 1.5; 

        const Icons = {
            Menu: (p) => <svg {...p} width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><line x1="4" x2="20" y1="12" y2="12"/><line x1="4" x2="20" y1="6" y2="6"/><line x1="4" x2="20" y1="18" y2="18"/></svg>,
            X: (p) => <svg {...p} width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M18 6 6 18"/><path d="m6 6 12 12"/></svg>,
            ArrowRight: (p) => <svg {...p} width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M5 12h14"/><path d="m12 5 7 7-7 7"/></svg>,
            Sun: (p) => <svg {...p} width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><circle cx="12" cy="12" r="4"/><path d="M12 2v2"/><path d="M12 20v2"/><path d="m4.93 4.93 1.41 1.41"/><path d="m17.66 17.66 1.41 1.41"/><path d="M2 12h2"/><path d="M20 12h2"/><path d="m6.34 17.66-1.41 1.41"/><path d="m19.07 4.93-1.41 1.41"/></svg>,
            Moon: (p) => <svg {...p} width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M12 3a6 6 0 0 0 9 9 9 9 0 1 1-9-9Z"/></svg>,
            Construction: (p) => <svg {...p} width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><rect x="2" y="6" width="20" height="8" rx="1"/><path d="M17 14v7"/><path d="M7 14v7"/><path d="M17 3v3"/><path d="M7 3v3"/><path d="M10 14 2.3 6.3"/><path d="m14 6 7.7 7.7"/><path d="m8 6 8 8"/></svg>,
            Excavator: (p) => <svg {...p} width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M2 17h2"/><path d="M20 17h2"/><path d="M2 12h2"/><path d="M9 22H5a1 1 0 0 1-1-1v-3"/><path d="M10 17h4"/><path d="M16 17a2 2 0 0 1 2 2v1a1 1 0 0 1-1 1H6"/><path d="M14 17V5l7-3v5"/></svg>,
            MapPin: (p) => <svg {...p} width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M20 10c0 6-8 12-8 12s-8-6-8-12a8 8 0 0 1 16 0Z"/><circle cx="12" cy="10" r="3"/></svg>
        };

        const useIsMobile = () => {
            const [isMobile, setIsMobile] = useState(false);
            useEffect(() => {
                const check = () => setIsMobile(window.innerWidth < 1024);
                check();
                window.addEventListener('resize', check);
                return () => window.removeEventListener('resize', check);
            }, []);
            return isMobile;
        };

        // --- UI COMPONENTS ---

        const ScrambleText = ({ text, className }) => {
            const [display, setDisplay] = useState(text);
            const chars = "ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789!@#$%^&*()";
            const scramble = () => {
                let iterations = 0;
                const interval = setInterval(() => {
                    setDisplay(text.split("").map((letter, index) => {
                        if (index < iterations) return text[index];
                        return chars[Math.floor(Math.random() * chars.length)];
                    }).join(""));
                    if (iterations >= text.length) clearInterval(interval);
                    iterations += 0.5; 
                }, 30);
            };
            return (
                <span onMouseEnter={scramble} className={className}>
                    {display}
                </span>
            );
        };

        const Magnetic = ({ children }) => {
            const ref = useRef(null);
            const position = { x: useMotionValue(0), y: useMotionValue(0) };
            
            const handleMouse = (e) => {
                const { clientX, clientY } = e;
                const { height, width, left, top } = ref.current.getBoundingClientRect();
                const middleX = clientX - (left + width / 2);
                const middleY = clientY - (top + height / 2);
                position.x.set(middleX * 0.25); 
                position.y.set(middleY * 0.25);
            };

            const reset = () => { position.x.set(0); position.y.set(0); };
            const { x, y } = position;
            return (
                <motion.div 
                    style={{ x, y }} 
                    ref={ref} 
                    onMouseMove={handleMouse} 
                    onMouseLeave={reset} 
                    transition={{ type: "spring", stiffness: 150, damping: 15, mass: 0.1 }}
                    className="inline-block"
                >
                    {children}
                </motion.div>
            );
        }

        const RevealText = ({ children, delay = 0, className = "" }) => {
            const ref = useRef(null);
            const initialDelay = useContext(DelayContext) || 0; 
            const combinedDelay = initialDelay + delay;
            const isInView = useInView(ref, { once: true, margin: "-10%" });
            return (
                <div ref={ref} className={`reveal-mask ${className}`}>
                    <motion.div 
                        initial={{ y: "110%", rotate: 2 }} 
                        animate={isInView ? { y: "0%", rotate: 0 } : {}} 
                        transition={{ duration: 1, ease: [0.33, 1, 0.68, 1], delay: combinedDelay }}
                    >
                        {children}
                    </motion.div>
                </div>
            );
        };

        const ParticleSwarmText = ({ text1, text2 }) => {
            const canvasRef = useRef(null);
            const containerRef = useRef(null);
            const { theme } = useContext(ThemeContext);
            const isInView = useInView(containerRef, { margin: "-20%" });
            
            useEffect(() => {
                const canvas = canvasRef.current;
                if (!canvas) return;
                const ctx = canvas.getContext('2d', { willReadFrequently: true });
                let animationFrameId;
                let particles = [];
                
                const PARTICLE_SIZE = 1.5; 
                const DENSITY = 5; 
                const GAP_BETWEEN_LINES = 100;

                const createParticles = () => {
                    if (!containerRef.current) return;
                    const width = containerRef.current.offsetWidth;
                    const height = containerRef.current.offsetHeight;
                    
                    const dpr = window.devicePixelRatio || 1;
                    canvas.width = width * dpr;
                    canvas.height = height * dpr;
                    canvas.style.width = `${width}px`;
                    canvas.style.height = `${height}px`;
                    ctx.scale(dpr, dpr);

                    ctx.clearRect(0, 0, width, height);
                    ctx.fillStyle = 'white';
                    ctx.font = '900 8vw "Oswald"'; 
                    ctx.textAlign = 'left';
                    ctx.textBaseline = 'top';

                    const startX = 0; 
                    const startY = (height / 2) - (120); 
                    ctx.fillText(text1, startX, startY);
                    ctx.fillText(text2, startX, startY + GAP_BETWEEN_LINES);

                    const imageData = ctx.getImageData(0, 0, width * dpr, height * dpr);
                    const data = imageData.data;
                    
                    particles = [];

                    for (let y = 0; y < height * dpr; y += DENSITY) {
                        for (let x = 0; x < width * dpr; x += DENSITY) {
                            const index = (y * (width * dpr) + x) * 4;
                            const alpha = data[index + 3];
                            if (alpha > 128) {
                                particles.push({
                                    x: (Math.random() * width * 3) - width, 
                                    y: (Math.random() * height * 3) - height,
                                    targetX: x / dpr,
                                    targetY: y / dpr,
                                    ease: 0.03 + Math.random() * 0.05,
                                    size: Math.random() < 0.5 ? PARTICLE_SIZE : PARTICLE_SIZE * 1.5 
                                });
                            }
                        }
                    }
                    ctx.clearRect(0, 0, width, height);
                };

                createParticles();
                window.addEventListener('resize', createParticles);

                const render = () => {
                    ctx.clearRect(0, 0, canvas.width / window.devicePixelRatio, canvas.height / window.devicePixelRatio);
                    const primaryColor = theme === 'dark' ? '#E5C579' : '#080808';
                    const secondaryColor = theme === 'dark' ? '#FFFFFF' : '#444444';
                    
                    particles.forEach(p => {
                        if (isInView) {
                            const dx = p.targetX - p.x;
                            const dy = p.targetY - p.y;
                            p.x += dx * p.ease;
                            p.y += dy * p.ease;
                        } 
                        ctx.fillStyle = Math.random() > 0.9 ? secondaryColor : primaryColor; 
                        ctx.globalAlpha = 0.9;
                        ctx.fillRect(p.x, p.y, p.size, p.size);
                    });
                    animationFrameId = requestAnimationFrame(render);
                };
                render();
                return () => {
                    window.removeEventListener('resize', createParticles);
                    cancelAnimationFrame(animationFrameId);
                };
            }, [text1, text2, isInView, theme]);

            return (
                <div ref={containerRef} className="w-full h-[400px] relative overflow-hidden pointer-events-none">
                    <canvas ref={canvasRef} className="absolute top-0 left-0" />
                </div>
            );
        };

        const Preloader = ({ onComplete }) => {
            const [progress, setProgress] = useState(0);
            const progressRef = useRef(null); 
            
            useEffect(() => {
                let loadedCount = 0;
                const total = ASSETS_TO_PRELOAD.length;
                const minimumTime = 1800; 
                const startTime = Date.now();

                const handleComplete = () => {
                    const elapsedTime = Date.now() - startTime;
                    const remainingTime = Math.max(0, minimumTime - elapsedTime);
                    setTimeout(() => {
                        onComplete();
                    }, remainingTime);
                }

                if (total === 0) {
                    setProgress(100); 
                    if(progressRef.current) progressRef.current.textContent = 100;
                    handleComplete();
                    return;
                }

                const updateProgress = () => {
                    loadedCount++;
                    const calculatedProgress = Math.min(100, (loadedCount / total) * 100);
                    const currentDisplayValue = progressRef.current ? parseFloat(progressRef.current.textContent) : 0;
                    window.Motion.animate(currentDisplayValue, calculatedProgress, {
                        duration: 0.8, 
                        ease: "easeOut",
                        onUpdate: (latest) => {
                            if(progressRef.current) {
                                progressRef.current.textContent = Math.floor(latest);
                            }
                        },
                        onComplete: () => {
                            if (loadedCount >= total) {
                                window.Motion.animate(parseFloat(progressRef.current.textContent), 100, {
                                    duration: 0.5,
                                    onUpdate: (latest) => { if(progressRef.current) progressRef.current.textContent = Math.floor(latest); },
                                    onComplete: handleComplete
                                });
                            }
                        }
                    });
                    setProgress(calculatedProgress);
                };

                ASSETS_TO_PRELOAD.forEach((src) => {
                    const img = new Image();
                    img.src = src;
                    img.onload = updateProgress;
                    img.onerror = updateProgress; 
                });
            }, []);

            return (
                <motion.div 
                    className="fixed inset-0 z-[9999] bg-onyx flex flex-col items-center justify-center text-champagne"
                    initial={{ y: 0 }}
                    exit={{ y: "-100%", transition: { duration: ENTRY_DELAY, ease: [0.83, 0, 0.17, 1] } }} 
                >
                    <div className="relative">
                        <motion.h1 
                            className="text-[12vw] md:text-[15vw] leading-none font-display font-bold tracking-tighter mix-blend-difference"
                            initial={{ y: '100%' }}
                            animate={{ y: 0 }}
                            transition={{ duration: 1, ease: [0.76, 0, 0.24, 1] }}
                        >
                            <span ref={progressRef} className="tabular-nums">0</span>%
                        </motion.h1>
                    </div>
                    <div className="w-64 h-[2px] bg-white/10 mt-8 overflow-hidden relative">
                        <motion.div className="absolute top-0 left-0 h-full bg-champagne" initial={{ width: "0%" }} animate={{ width: `${progress}%` }} transition={{ duration: 0.8, ease: "linear" }} />
                    </div>
                </motion.div>
            );
        };

        const BreathingLogo = ({ src, alt }) => {
            return (
                <motion.div
                    whileHover={{ scale: 1.1, filter: "grayscale(0%) opacity(1)", transition: { duration: 0.3 } }}
                    className="relative"
                >
                    <motion.img 
                        src={src} 
                        alt={alt}
                        className="h-8 md:h-12 object-contain"
                        animate={{
                            filter: ["grayscale(100%) opacity(0.4)", "grayscale(0%) opacity(1)", "grayscale(100%) opacity(0.4)"],
                            scale: [1, 1.05, 1]
                        }}
                        transition={{ duration: 4, repeat: Infinity, ease: "easeInOut" }}
                    />
                </motion.div>
            );
        };

        // --- SECTIONS ---

        const Navbar = () => {
            const [isOpen, setIsOpen] = useState(false);
            const lenis = useContext(ScrollContext);
            const { setCursorState } = useContext(CursorContext);
            const initialDelay = useContext(DelayContext); 

            const scrollTo = (id) => {
                setIsOpen(false);
                lenis?.scrollTo(id, { duration: 1.5 });
            };

            const menuItems = ["Projects", "Expertise", "Fleet", "Contact"];

            return (
                <>
                    <motion.nav 
                        initial={{ y: -100 }} 
                        animate={{ y: 0 }} 
                        transition={{ delay: initialDelay + 0.3, duration: 0.8, ease: [0.33, 1, 0.68, 1] }}
                        className="fixed top-0 left-0 right-0 z-40 px-6 py-6 flex justify-between items-center mix-blend-difference text-white pointer-events-none"
                    >
                        <div 
                            className="flex items-center gap-3 pointer-events-auto cursor-pointer group"
                            onClick={() => scrollTo('#top')}
                            onMouseEnter={() => { setCursorState('pointer'); }}
                            onMouseLeave={() => setCursorState('default')}
                        >
                            <img src="assets/logo.png" alt="Logo" className="w-10 h-10 object-contain bg-white p-1 rounded-lg" />
                            <div className="hidden md:block">
                                <span className="font-display font-bold text-lg tracking-wide block leading-none group-hover:text-champagne transition-colors">FKR INFRA</span>
                                <span className="text-[10px] uppercase tracking-[0.4em] opacity-70">Pvt Ltd</span>
                            </div>
                        </div>

                        <div className="hidden md:flex items-center gap-10 pointer-events-auto">
                            {menuItems.map((item) => (
                                <Magnetic key={item}>
                                    <button 
                                        onClick={() => scrollTo(`#${item.toLowerCase()}`)}
                                        className="text-xs font-bold uppercase tracking-[0.2em] hover:text-champagne transition-colors relative group px-2 py-1"
                                        onMouseEnter={() => { setCursorState('pointer'); }}
                                        onMouseLeave={() => setCursorState('default')}
                                    >
                                        <ScrambleText text={item} />
                                        <span className="absolute -bottom-1 left-0 w-0 h-[1px] bg-champagne transition-all group-hover:w-full"></span>
                                    </button>
                                </Magnetic>
                            ))}
                            <Magnetic>
                                <a 
                                    href="assets/FKR-INFRA-PRIVATE-LIMITED.pdf" 
                                    download
                                    className="px-6 py-2 border border-white/30 rounded-full text-xs font-bold uppercase tracking-[0.2em] hover:bg-champagne hover:border-champagne hover:text-onyx transition-all"
                                    onMouseEnter={() => { setCursorState('pointer'); }}
                                    onMouseLeave={() => setCursorState('default')}
                                >
                                    Profile
                                </a>
                            </Magnetic>
                        </div>

                        <div className="md:hidden pointer-events-auto">
                             <Magnetic>
                                <button onClick={() => setIsOpen(true)} className="p-2" onMouseEnter={() => { setCursorState('pointer'); }} onMouseLeave={() => setCursorState('default')}>
                                    <Icons.Menu size={24} />
                                </button>
                            </Magnetic>
                        </div>
                    </motion.nav>

                    <AnimatePresence>
                        {isOpen && (
                            <motion.div 
                                initial={{ clipPath: "circle(0% at 100% 0%)" }}
                                animate={{ clipPath: "circle(150% at 100% 0%)" }}
                                exit={{ clipPath: "circle(0% at 100% 0%)" }}
                                transition={{ duration: 0.8, ease: [0.76, 0, 0.24, 1] }}
                                className="fixed inset-0 bg-onyx z-50 flex flex-col items-center justify-center text-white"
                            >
                                <button onClick={() => setIsOpen(false)} className="absolute top-6 right-6 p-2 rounded-full border border-white/10">
                                    <Icons.X size={24} />
                                </button>
                                <div className="flex flex-col gap-8 text-center">
                                    {menuItems.map((item, i) => (
                                        <motion.button
                                            key={item}
                                            initial={{ y: 100, opacity: 0 }}
                                            animate={{ y: 0, opacity: 1 }}
                                            transition={{ delay: 0.2 + (i * 0.1), ease: [0.33, 1, 0.68, 1] }}
                                            onClick={() => scrollTo(`#${item.toLowerCase()}`)}
                                            className="text-5xl font-display font-bold uppercase text-transparent text-stroke-dynamic hover:text-champagne hover:text-stroke-0 transition-all"
                                        >
                                            {item}
                                        </motion.button>
                                    ))}
                                </div>
                            </motion.div>
                        )}
                    </AnimatePresence>
                </>
            );
        };

        const Hero = () => {
            const { scrollY } = useScroll();
            const initialDelay = useContext(DelayContext); 

            const yText1 = useTransform(scrollY, [0, 1000], [0, -100]); 
            const yText2 = useTransform(scrollY, [0, 1000], [0, 400]); 
            const opacity = useTransform(scrollY, [0, 500], [1, 0]);
            const scale = useTransform(scrollY, [0, 1000], [1.1, 1]);

            const mouseX = useMotionValue(0);
            const mouseY = useMotionValue(0);
            
            const handleMouseMove = (e) => {
                const { clientX, clientY } = e;
                const moveX = (clientX - window.innerWidth / 2) * 0.01; 
                const moveY = (clientY - window.innerHeight / 2) * 0.01;
                mouseX.set(moveX);
                mouseY.set(moveY);
            };

            useEffect(() => {
                window.addEventListener("mousemove", handleMouseMove);
                return () => window.removeEventListener("mousemove", handleMouseMove);
            }, []);

            return (
                <section id="top" className="relative h-screen w-full overflow-hidden flex items-center justify-center">
                    <motion.div style={{ x: mouseX, y: mouseY, scale, opacity }} className="absolute inset-0 z-0">
                        <div className="absolute inset-0 bg-gradient-to-b from-black/40 via-transparent to-paper dark:to-onyx z-10" />
                        <motion.div 
                            initial={{ clipPath: "inset(100% 0 0 0)" }} 
                            animate={{ clipPath: "inset(0% 0 0 0)" }} 
                            transition={{ duration: 1.5, ease: [0.76, 0, 0.24, 1], delay: initialDelay }} 
                            className="w-full h-full"
                        >
                            <img src="assets/RJ.jpg" alt="Heavy duty piling machine on site" className="w-full h-full object-cover" />
                        </motion.div>
                    </motion.div>

                    <div className="relative z-20 container mx-auto px-6 flex flex-col justify-center h-full pointer-events-none">
                        <div className="overflow-hidden mb-4">
                            <motion.p 
                                initial={{ y: "100%" }} 
                                animate={{ y: 0 }} 
                                transition={{ delay: initialDelay + 0.5, duration: 0.8, ease: [0.33, 1, 0.68, 1] }} 
                                className="text-champagne font-mono text-xs md:text-sm uppercase tracking-[0.4em]"
                            >
                                Managed by Mr. Khan Faiyaz
                            </motion.p>
                        </div>
                        
                        <h1 className="text-[13vw] md:text-[12vw] leading-[0.8] font-display font-bold uppercase text-onyx dark:text-white mix-blend-normal dark:mix-blend-overlay transition-colors duration-500 flex flex-col">
                            <motion.div style={{ y: yText1, x: mouseX }}> 
                                <RevealText delay={0.6}>Beyond</RevealText>
                            </motion.div>
                            <motion.div style={{ y: yText2, x: mouseX }}>
                                <RevealText delay={0.7} className="text-stroke-dynamic">Structure</RevealText>
                            </motion.div>
                        </h1>

                        <motion.div 
                            initial={{ opacity: 0, y: 20 }} 
                            animate={{ opacity: 1, y: 0 }} 
                            transition={{ delay: initialDelay + 1.2, duration: 0.8 }} 
                            className="mt-12 max-w-lg pointer-events-auto"
                        >
                             <p className="text-ink/80 dark:text-white/80 text-lg md:text-xl font-light leading-relaxed backdrop-blur-sm transition-colors duration-500">
                                Precision excavation and heavy-duty piling for India's urban giants. We lay the groundwork for the future.
                            </p>
                        </motion.div>
                    </div>
                </section>
            );
        };

        const Marquee = () => {
            return (
                <div className="py-12 bg-champagne overflow-hidden whitespace-nowrap border-y border-black">
                    <div className="inline-flex animate-marquee">
                        {[...Array(4)].map((_, i) => (
                            <div key={i} className="flex items-center gap-12 mx-6">
                                <span className="text-6xl md:text-8xl font-display font-bold text-onyx uppercase">Building The Future</span>
                                <img src="assets/logo.png" className="h-16 w-16 object-contain opacity-20" />
                                <span className="text-6xl md:text-8xl font-display font-bold text-transparent text-stroke-dynamic [-webkit-text-stroke:1px_#080808] uppercase">Safety First</span>
                                <Icons.Construction size={48} className="text-onyx opacity-50" />
                            </div>
                        ))}
                    </div>
                </div>
            );
        }

        const StickyProjects = () => {
            const { setCursorState, setCursorText } = useContext(CursorContext);
            const [activeProject, setActiveProject] = useState(0);
            const isMobile = useIsMobile();
            const containerRef = useRef(null);
            
            // Sync scroll progress
            const { scrollYProgress } = useScroll({
                target: containerRef,
                offset: ["start start", "end end"]
            });

            const projects = [
                {
                    title: "Godrej Horizon",
                    location: "Wadala, Mumbai",
                    desc: "A monumental excavation project executed with precision in the heart of Wadala. Over 250,000 cubic meters of earth moved.",
                    tags: ["Excavation", "Piling"],
                    img: "assets/Godrej Horizon.jpg"
                },
                {
                    title: "Piramal Agastya",
                    location: "Kurla, Mumbai",
                    desc: "Complex foundational work for Piramal's corporate park. Involved intricate rock anchoring and deep piling techniques.",
                    tags: ["Civil", "Anchoring"],
                    img: "assets/Piramal Agastya.jpg"
                },
                {
                    title: "Shagun Group",
                    location: "Malad, Mumbai",
                    desc: "High-speed earthworks and basement preparation for a premium residential tower. Delivered ahead of schedule.",
                    tags: ["Earthworks", "Infra"],
                    img: "assets/Shagun grp.jpg"
                },
                {
                    title: "Tricone",
                    location: "Mumbai",
                    desc: "Large scale infrastructure development involving heavy machinery and logistical coordination.",
                    tags: ["Development", "Civil"],
                    img: "assets/Tricone.webp"
                },
                {
                    title: "Prince Aly",
                    location: "Mazgaon",
                    desc: "Specialized hospital infrastructure excavation requiring low-noise and low-vibration techniques.",
                    tags: ["Specialized", "Medical"],
                    img: "assets/prince.png"
                }
            ];

            useMotionValueEvent(scrollYProgress, "change", (latest) => {
                const total = projects.length;
                if (total === 0) return;
                let index = Math.round(latest * (total - 1));
                index = Math.min(Math.max(index, 0), total - 1);
                
                if (index !== activeProject) {
                    setActiveProject(index);
                }
            });

            // --- DYNAMIC VARIANT GENERATOR ---
            // This creates a unique transition for each project based on its index
            // Crucially, it applies the "Cover" logic: The active image animates ON TOP of the inactive one.
            const getVariants = (index) => {
                const type = index % 4;
                
                // Common Transition Settings
                const trans = { duration: 0.8, ease: [0.76, 0, 0.24, 1] };

                switch(type) {
                    case 0: // Wipe Up
                        return {
                            active: { clipPath: 'inset(0% 0% 0% 0%)', zIndex: 10, scale: 1, transition: trans },
                            inactive: { clipPath: 'inset(100% 0% 0% 0%)', zIndex: 1, scale: 1.1, transition: trans }
                        };
                    case 1: // Wipe Left
                        return {
                            active: { clipPath: 'inset(0% 0% 0% 0%)', zIndex: 10, scale: 1, transition: trans },
                            inactive: { clipPath: 'inset(0% 0% 0% 100%)', zIndex: 1, scale: 1.1, transition: trans }
                        };
                    case 2: // Circle Expand
                        return {
                            active: { clipPath: 'circle(150% at 50% 50%)', zIndex: 10, scale: 1, transition: trans },
                            inactive: { clipPath: 'circle(0% at 50% 50%)', zIndex: 1, scale: 0.8, transition: trans }
                        };
                    case 3: // Wipe Right (or Diagonal)
                        return {
                            active: { clipPath: 'inset(0% 0% 0% 0%)', zIndex: 10, scale: 1, transition: trans },
                            inactive: { clipPath: 'inset(0% 100% 0% 0%)', zIndex: 1, scale: 1.1, transition: trans }
                        };
                    default: 
                         return {
                            active: { opacity: 1, zIndex: 10, transition: trans },
                            inactive: { opacity: 0, zIndex: 1, transition: trans }
                        };
                }
            };

            return (
                <section id="projects" ref={containerRef} className="relative bg-paper dark:bg-charcoal transition-colors">
                    {!isMobile && (
                        <div className="flex">
                            <div className="w-1/2 z-20 relative mix-blend-difference text-white pointer-events-none"> 
                                {projects.map((p, i) => (
                                    <div key={i} className="h-screen flex flex-col justify-center px-6 lg:px-20 border-r border-white/10">
                                        <div className={`transition-opacity duration-500 ${activeProject === i ? 'opacity-100' : 'opacity-20'}`}>
                                            <span className="font-mono text-sm mb-4 tracking-widest block text-champagne">0{i + 1} / 05</span>
                                            <h2 className="text-4xl md:text-6xl font-display font-bold mb-6">
                                                {p.title}
                                            </h2>
                                            <p className="text-lg md:text-xl max-w-md leading-relaxed mb-8">
                                                {p.desc}
                                            </p>
                                            <div className="flex flex-wrap gap-3">
                                                {p.tags.map(t => (
                                                    <span key={t} className="px-4 py-1 border border-current rounded-full text-xs uppercase tracking-wider">{t}</span>
                                                ))}
                                            </div>
                                        </div>
                                    </div>
                                ))}
                            </div>
                            
                            {/* STACKED IMAGE CONTAINER WITH UNIQUE TRANSITIONS */}
                            <div className="w-1/2 h-screen sticky top-0 overflow-hidden bg-black z-10">
                                {projects.map((p, i) => (
                                    <motion.div 
                                        key={i} 
                                        className="absolute inset-0 w-full h-full"
                                        initial={false} 
                                        animate={activeProject === i ? "active" : "inactive"}
                                        variants={getVariants(i)}
                                    >
                                        <img 
                                            src={p.img} 
                                            className="w-full h-full object-cover" 
                                            alt={p.title} 
                                            onMouseEnter={() => { setCursorState('pointer'); }} 
                                            onMouseLeave={() => setCursorState('default')} 
                                        />
                                        <div className="absolute inset-0 bg-black/20" />
                                        <div className="absolute bottom-10 right-10 bg-black/50 backdrop-blur-sm px-6 py-3 text-white border border-white/10 rounded-xl z-20">
                                            <span className="font-mono text-sm uppercase tracking-widest">{p.location}</span>
                                        </div>
                                    </motion.div>
                                ))}
                            </div>
                        </div>
                    )}

                    {isMobile && (
                        <div className="py-20 px-6 bg-paper dark:bg-onyx">
                            <h2 className="text-5xl font-display font-bold mb-12 text-onyx dark:text-white">SELECTED <br/><span className="text-champagne">WORKS</span></h2>
                            <div className="space-y-20">
                                {projects.map((p, i) => (
                                    <div key={i} className="group">
                                        <div className="aspect-[4/3] w-full overflow-hidden rounded-2xl bg-gray-800 relative mb-6 shadow-2xl">
                                            <div className="absolute inset-0 bg-black/10 z-10" />
                                            <img src={p.img} className="w-full h-full object-cover transition-transform duration-700 group-hover:scale-110" alt={p.title} />
                                            <div className="absolute top-4 right-4 bg-champagne text-onyx px-3 py-1 text-xs font-bold uppercase tracking-widest rounded-full z-20">0{i+1}</div>
                                        </div>
                                        <div>
                                            <h3 className="text-3xl font-display font-bold mb-2 text-onyx dark:text-white">{p.title}</h3>
                                            <p className="opacity-70 mb-4 text-sm leading-relaxed text-ink dark:text-white/70">{p.desc}</p>
                                            <div className="flex flex-wrap gap-2 opacity-60">
                                                {p.tags.map(t => <span key={t} className="text-xs border border-current px-2 py-1 rounded-full text-ink dark:text-white/70">{t}</span>)}
                                            </div>
                                        </div>
                                    </div>
                                ))}
                            </div>
                        </div>
                    )}
                </section>
            );
        };

        const Expertise = () => {
            const targetRef = useRef(null);
            const { scrollYProgress } = useScroll({ target: targetRef });
            const isMobile = useIsMobile();
            const x = useTransform(scrollYProgress, [0, 1], ["0%", isMobile ? "-100%" : "-65%"]); 
            const { setCursorState } = useContext(CursorContext);

            const services = [
                { title: "Deep Piling", icon: <Icons.Construction size={48} />, desc: "Foundation stability using high-capacity rotary rigs for deep urban projects." },
                { title: "Mass Excavation", icon: <Icons.Excavator size={48} />, desc: "High-volume earthworks and basement preparation. Moving material efficiently and safely." },
                { title: "Rock Anchoring", icon: <Icons.MapPin size={48} />, desc: "Specialized structural concrete anchoring and shoring for superior ground retention." },
                { title: "Logistics & Fleet", icon: <Icons.ArrowRight size={48} />, desc: "Seamless transport, maintenance, and deployment of our owned, modern machinery fleet." }
            ];

            if (isMobile) {
                return (
                    <section id="expertise" className="py-20 px-6 bg-paper dark:bg-onyx text-ink dark:text-white transition-colors">
                         <h2 className="text-5xl font-display font-bold mb-12">OUR <br/><span className="text-champagne">EXPERTISE</span></h2>
                        <div className="grid gap-6">
                             {services.map((s, i) => (
                                <div key={i} className="bg-white dark:bg-charcoal border border-black/10 dark:border-white/10 p-8 rounded-xl">
                                    <div className="text-champagne mb-4">{s.icon}</div>
                                    <h3 className="text-2xl font-display font-bold mb-2">{s.title}</h3>
                                    <p className="text-ink/50 dark:text-white/50 text-sm">{s.desc}</p>
                                </div>
                             ))}
                        </div>
                    </section>
                );
            }

            return (
                <section id="expertise" ref={targetRef} className="relative h-[300vh] bg-paper dark:bg-onyx text-ink dark:text-white transition-colors">
                    <div className="sticky top-0 h-screen flex items-center overflow-hidden">
                        <div className="absolute inset-0 bg-[url('data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjAiIGhlaWdodD0iMjAiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+PGNpcmNsZSBjeD0iMSIgY3k9IjEiIHI9IjEiIGZpbGw9InJnYmEoMjU1LDI1NSwyNTUsMC4wNSkiLz48L3N2Zz4=')] opacity-20 dark:bg-[url('data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjAiIGhlaWdodD0iMjAiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+PGNpcmNsZSBjeD0iMSIgY3k9IjEiIHI9IjEiIGZpbGw9InJnYmEoMCwwLDAsMC4wNSkiLz48L3N2Zz4=')] pointer-events-none"></div>
                        
                        <motion.div style={{ x }} className="flex items-center gap-12 px-20">
                            <div className="min-w-[40vw]">
                                <div className="relative z-10">
                                     <ParticleSwarmText text1="OUR" text2="EXPERTISE" />
                                </div>
                                <p className="mt-8 text-xl opacity-60 max-w-md">We control the ground so you can build the sky. Specialized in geotechnical engineering and infrastructure.</p>
                            </div>
                            {services.map((s, i) => (
                                <motion.div 
                                    key={i} 
                                    className="min-w-[25vw] aspect-[4/5] bg-white dark:bg-charcoal border border-black/10 dark:border-white/10 p-10 flex flex-col justify-between group hover:border-champagne hover:shadow-2xl hover:shadow-champagne/10 transition-all duration-500 relative overflow-hidden rounded-xl" 
                                    onMouseEnter={() => { setCursorState('pointer'); }} 
                                    onMouseLeave={() => setCursorState('default')}
                                >
                                    <div className="absolute -right-10 -bottom-10 opacity-5 group-hover:opacity-10 transition-opacity duration-500"><div className="scale-[3] text-champagne">{s.icon}</div></div>
                                    <div className="text-champagne group-hover:scale-110 transition-transform duration-500 origin-top-left">{s.icon}</div>
                                    <div className="relative z-10"><h3 className="text-3xl font-display font-bold mb-4">{s.title}</h3><p className="text-ink/50 dark:text-white/50 leading-relaxed">{s.desc}</p></div>
                                    <div className="w-full h-[1px] bg-black/10 dark:bg-white/10 overflow-hidden">
                                        <motion.div className="h-full bg-champagne w-0 group-hover:w-full transition-all duration-500 ease-out" />
                                    </div>
                                </motion.div>
                            ))}
                        </motion.div>
                    </div>
                </section>
            );
        };

        const NumberTicker = ({ value }) => {
            const ref = useRef(null);
            const isInView = useInView(ref, { once: true, margin: "-50px" });
            
            useEffect(() => {
                if (isInView && ref.current) {
                    const controls = animate(0, value, {
                        duration: 2.5,
                        ease: "easeOut",
                        onUpdate: (latest) => {
                            if(ref.current) {
                                ref.current.textContent = Math.floor(latest).toLocaleString();
                            }
                        }
                    });
                    return () => controls.stop();
                }
            }, [isInView, value]);

            return <span ref={ref} className="tabular-nums">0</span>;
        };

        const Fleet = () => {
            return (
                <section id="fleet" className="py-24 md:py-32 px-6 md:px-20 bg-champagne text-onyx relative overflow-hidden">
                    <div className="grid lg:grid-cols-2 gap-12 md:gap-20 relative z-10">
                        <div>
                            <span className="block text-xs font-bold uppercase tracking-[0.3em] mb-4">The Arsenal</span>
                            <h2 className="text-5xl md:text-8xl font-display font-bold mb-6 md:mb-8 leading-[0.9]">OWNED <br/> FLEET.</h2>
                            <p className="text-lg md:text-xl font-medium opacity-80 max-w-md">No rentals. No delays. We own our machinery to guarantee project timelines and execution quality.</p>
                        </div>
                        <div className="grid grid-cols-2 gap-8 md:gap-12">
                            {[{ label: "Excavators", val: 10 }, { label: "Piling Rigs", val: 5 }, { label: "Major Projects", val: 50 }, { label: "Years Experience", val: 9 }].map((item, i) => (
                                <motion.div 
                                    key={i} 
                                    className="border-t border-onyx/20 pt-6 cursor-default group"
                                    whileHover={{ y: -5, transition: { duration: 0.2 } }}
                                >
                                    <span className="text-4xl md:text-7xl font-display font-bold block mb-2 overflow-hidden h-[1em]">
                                        <NumberTicker value={item.val} />+
                                    </span>
                                    <span className="uppercase tracking-widest text-xs font-bold opacity-60 group-hover:opacity-100 transition-opacity">
                                        <ScrambleText text={item.label} />
                                    </span>
                                </motion.div>
                            ))}
                        </div>
                    </div>
                </section>
            );
        };

        const Partners = () => {
            const logos = [
                { src: "assets/godrej.png", alt: "Godrej Properties" },
                { src: "assets/adani.png", alt: "Adani Realty" },
                { src: "assets/Mahindra.png", alt: "Mahindra Lifespaces" },
                { src: "assets/ruparel.png", alt: "Ruparel Realty" },
                { src: "assets/shagun.png", alt: "Shagun Group" }
            ];

            return (
                <section className="py-32 bg-paper dark:bg-onyx transition-colors border-t border-black/5 dark:border-white/5">
                    <div className="container mx-auto px-6 text-center">
                        <span className="text-xs font-bold uppercase tracking-[0.3em] text-ink/50 dark:text-white/50 mb-16 block">
                            Trusted By Industry Leaders
                        </span>
                        <div className="flex flex-wrap justify-center items-center gap-12 md:gap-24">
                            {logos.map((logo, index) => (
                                <BreathingLogo key={index} src={logo.src} alt={logo.alt} />
                            ))}
                        </div>
                    </div>
                </section>
            );
        };

        const Footer = () => {
            const [formStatus, setFormStatus] = useState('idle');
            const { setCursorState } = useContext(CursorContext);
            const footerTextRef = useRef(null);
            
            const handleFooterMouseMove = (e) => {
               if(!footerTextRef.current) return;
               const { clientX, clientY } = e;
               const { left, top, width, height } = footerTextRef.current.getBoundingClientRect();
               const x = (clientX - left) / width - 0.5;
               const y = (clientY - top) / height - 0.5;
               footerTextRef.current.style.transform = `perspective(1000px) rotateY(${x * 8}deg) rotateX(${y * -8}deg)`;
            };

            const handleFooterMouseLeave = () => {
                if(footerTextRef.current) footerTextRef.current.style.transform = 'none';
            };

            const handleSubmit = (e) => {
                e.preventDefault();
                setFormStatus('sending');
                setTimeout(() => { 
                    setFormStatus('success'); 
                    e.target.reset(); 
                    setTimeout(() => setFormStatus('idle'), 3000); 
                }, 1500);
            };

            return (
                <footer id="contact" className="bg-onyx text-white pt-24 md:pt-32 pb-12 px-6 md:px-20 border-t border-white/10 relative">
                    <div className="grid lg:grid-cols-2 gap-16 md:gap-24 mb-32">
                        <div>
                            <RevealText>
                                <div 
                                    ref={footerTextRef}
                                    onMouseMove={handleFooterMouseMove}
                                    onMouseLeave={handleFooterMouseLeave}
                                    className="transition-transform duration-200 ease-out will-change-transform"
                                >
                                    <h2 className="text-7xl md:text-[10vw] font-display font-bold mb-12 leading-[0.9] tracking-tighter cursor-default">
                                        LET'S <br/> BUILD.
                                    </h2>
                                </div>
                            </RevealText>
                            <div className="space-y-8 text-lg opacity-70 font-light">
                                <p>318 Bldg No 2 Motilal Nehru Nagar,<br/>BKC Bandra East, Mumbai 400051</p>
                                <div className="flex flex-col gap-2">
                                    <a href="tel:+917021156299" className="hover:text-champagne transition-colors w-fit">+91 7021156299</a>
                                    <a href="mailto:info.fkrinfra@gmail.com" className="hover:text-champagne transition-colors w-fit">info.fkrinfra@gmail.com</a>
                                </div>
                            </div>
                        </div>

                        <form onSubmit={handleSubmit} className="space-y-12 mt-12">
                            {["NAME", "EMAIL", "PROJECT DETAILS"].map((ph, i) => (
                                <div key={ph} className="relative group">
                                    {i === 2 ? (
                                        <textarea 
                                            placeholder={ph} 
                                            rows="3" 
                                            className="w-full bg-white/5 border-b border-white/40 py-4 px-2 focus:outline-none input-enhanced placeholder:text-white/60 focus:text-white focus:border-champagne transition-colors text-xl resize-none peer relative z-10" 
                                        />
                                    ) : (
                                        <input 
                                            type={ph === "EMAIL" ? "email" : "text"} 
                                            placeholder={ph} 
                                            required 
                                            className="w-full bg-white/5 border-b border-white/40 py-4 px-2 focus:outline-none input-enhanced placeholder:text-white/60 focus:text-white focus:border-champagne transition-colors text-xl peer relative z-10" 
                                        />
                                    )}
                                    <div className="absolute bottom-0 left-0 w-full h-[1px] bg-champagne scale-x-0 peer-focus:scale-x-100 transition-transform duration-500 origin-left z-20"></div>
                                </div>
                            ))}
                            <Magnetic>
                                <button type="submit" className="px-12 py-6 bg-champagne text-onyx font-bold uppercase tracking-widest hover:bg-white transition-colors w-full md:w-auto text-sm rounded-full" onMouseEnter={() => { setCursorState('pointer'); }} onMouseLeave={() => setCursorState('default')}>
                                    {formStatus === 'idle' ? 'Send Enquiry' : formStatus === 'sending' ? 'Sending...' : 'Message Sent'}
                                </button>
                            </Magnetic>
                        </form>
                    </div>

                    <div className="flex flex-col md:flex-row justify-between items-center opacity-30 text-[10px] uppercase tracking-widest gap-4">
                        <p> 2025 FKR INFRA PVT LTD</p>
                        <p>DESIGNED WITH PRECISION</p>
                    </div>
                </footer>
            );
        };

        const CustomCursor = () => {
            const { cursorText, cursorState } = useContext(CursorContext);
            const mouseX = useMotionValue(-100);
            const mouseY = useMotionValue(-100);
            const springConfig = { damping: 20, stiffness: 200, mass: 0.3 };
            const smoothX = useSpring(mouseX, springConfig);
            const smoothY = useSpring(mouseY, springConfig);
            
            useEffect(() => {
                const move = (e) => { mouseX.set(e.clientX); mouseY.set(e.clientY); };
                window.addEventListener("mousemove", move);
                return () => window.removeEventListener("mousemove", move);
            }, []);

            useEffect(() => {
                if (cursorState === 'pointer') {
                    document.body.classList.add('pointer-active');
                } else {
                    document.body.classList.remove('pointer-active');
                }
            }, [cursorState]);

            return (
                <motion.div 
                    className={`custom-cursor ${cursorState === 'active' ? 'active' : ''} ${cursorState === 'pointer' ? 'pointer-mode' : ''}`} 
                    style={{ x: smoothX, y: smoothY }}
                >
                    <AnimatePresence>
                        {cursorState === 'active' && cursorText && (
                            <motion.span 
                                initial={{ opacity: 0 }} 
                                animate={{ opacity: 1 }} 
                                exit={{ opacity: 0 }}
                                className="custom-cursor-text"
                            >
                                {cursorText}
                            </motion.span>
                        )}
                    </AnimatePresence>
                </motion.div>
            );
        };

        const App = () => {
            const [loading, setLoading] = useState(true);
            const [cursorState, setCursorState] = useState('default');
            const [cursorText, setCursorText] = useState('');
            const [lenis, setLenis] = useState(null);
            const { scrollYProgress } = useScroll();
            const [isPageReady, setIsPageReady] = useState(false);

            const [theme, setTheme] = useState(localStorage.getItem('theme') || 'dark');
            useEffect(() => { document.documentElement.classList.toggle('dark', theme === 'dark'); localStorage.setItem('theme', theme); }, [theme]);
            const toggleTheme = () => setTheme(prev => prev === 'dark' ? 'light' : 'dark');

            useEffect(() => {
                if (loading) return; 

                const lenisInstance = new Lenis({ 
                    duration: 1.2, 
                    easing: (t) => Math.min(1, 1.001 - Math.pow(2, -10 * t)),
                    smoothTouch: true,
                    smoothWheel: true,
                    lerp: 0.08
                });
                setLenis(lenisInstance);

                function raf(time) { 
                    lenisInstance.raf(time); 
                    requestAnimationFrame(raf); 
                }
                
                requestAnimationFrame(raf);
                return () => lenisInstance.destroy();
            }, [loading]);

            return (
                <ThemeContext.Provider value={{ theme, toggleTheme }}>
                    <CursorContext.Provider value={{ cursorState, setCursorState, cursorText, setCursorText }}>
                        <ScrollContext.Provider value={lenis}>
                            <DelayContext.Provider value={ENTRY_DELAY}>
                            
                                <div className="min-h-screen relative">
                                    <div className="bg-noise"></div>
                                    <CustomCursor />
                                    
                                    <AnimatePresence mode="wait" onExitComplete={() => setIsPageReady(true)}>
                                        {loading ? (
                                            <Preloader key="loader" onComplete={() => setLoading(false)} />
                                        ) : (
                                            <motion.div 
                                                key="content" 
                                                className="relative z-10"
                                                initial={{ opacity: 0 }}
                                                animate={{ opacity: 1 }}
                                                transition={{ delay: ENTRY_DELAY, duration: 0.5 }}
                                            >
                                                <Navbar />
                                                <main>
                                                    <Hero />
                                                    <Marquee />
                                                    <StickyProjects />
                                                    <Expertise />
                                                    <Fleet />
                                                    <Partners />
                                                    <Footer />
                                                </main>
                                            </motion.div>
                                        )}
                                    </AnimatePresence>

                                    {!loading && (
                                        <motion.div 
                                            className="fixed top-0 left-0 h-1 bg-champagne z-50"
                                            style={{ scaleX: scrollYProgress, transformOrigin: "0%" }}
                                        />
                                    )}

                                    {!loading && (
                                        <div className="fixed bottom-8 right-8 z-50">
                                            <Magnetic>
                                                <button 
                                                    onClick={toggleTheme}
                                                    className="w-14 h-14 rounded-full bg-onyx/10 dark:bg-white/10 backdrop-blur-md border border-current flex items-center justify-center transition-colors text-white"
                                                    onMouseEnter={() => { setCursorState('pointer'); }}
                                                    onMouseLeave={() => setCursorState('default')}
                                                >
                                                    {theme === 'dark' ? <Icons.Sun size={20} /> : <Icons.Moon size={20} />}
                                                </button>
                                            </Magnetic>
                                        </div>
                                    )}
                                </div>

                            </DelayContext.Provider>
                        </ScrollContext.Provider>
                    </CursorContext.Provider>
                </ThemeContext.Provider>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>